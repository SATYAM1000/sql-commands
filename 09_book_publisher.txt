SELECT CITY, PHONE, URL
FROM AUTHOR
WHERE ANAME = 'CHETAN BHAGAT';

SELECT B.BOOK_TITLE, R.RID, R.RATING
FROM BOOK B
LEFT JOIN REVIEW R ON B.ISBN = R.ISBN;

SELECT B.BOOK_TITLE, B.PRICE, A.ANAME, A.URL
FROM BOOK B
JOIN AUTHOR_BOOK AB ON B.ISBN = AB.ISBN
JOIN AUTHOR A ON AB.AID = A.AID
WHERE B.PID IN (SELECT PID FROM PUBLISHER WHERE PNAME = 'MEHTA');

UPDATE PUBLISHER
SET PHONE = '123456'
WHERE PNAME = 'MEHTA';

SELECT PID, PNAME, AVG(PRICE) AS AVG_PRICE, MAX(PRICE) AS MAX_PRICE, MIN(PRICE) AS MIN_PRICE
FROM PUBLISHER P
JOIN BOOK B ON P.PID = B.PID
GROUP BY PID, PNAME;

DELETE FROM BOOK
WHERE PAGE_COUNT < 100;


SELECT *
FROM AUTHOR
WHERE CITY = 'Pune' AND ANAME LIKE 'C%';

SELECT A.*
FROM AUTHOR A
WHERE CITY = (SELECT CITY FROM AUTHOR WHERE ANAME = 'Korth');

CREATE PROCEDURE UpdatePageCount(IN isbn_param INT, IN page_count_param INT)
BEGIN
    UPDATE BOOK
    SET PAGE_COUNT = page_count_param
    WHERE ISBN = isbn_param;
END;

CREATE FUNCTION GetBookPrice(ISBN_param INT) RETURNS DECIMAL(10, 2)
BEGIN
    DECLARE book_price DECIMAL(10, 2);
    SELECT PRICE INTO book_price FROM BOOK WHERE ISBN = ISBN_param;
    RETURN book_price;
END;
